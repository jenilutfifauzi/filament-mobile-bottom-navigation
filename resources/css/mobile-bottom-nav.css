/**
 * Filament Mobile Bottom Navigation
 * Mobile-First CSS Architecture
 *
 * Default styles: Mobile (< 768px) - bottom nav visible
 * Desktop styles: ≥ 768px - bottom nav hidden
 */

/* ============================================
   CSS VARIABLES
   ============================================ */

/**
 * Navigation Height Calculation:
 * - Icon: 24px (1.5rem)
 * - Icon margin-bottom: 4px (0.25rem)
 * - Label line-height: 16px (1rem)
 * - Vertical padding: 12px × 2 = 24px (0.75rem × 2)
 * - Border-top: 1px
 * - Safe area: 0-34px (env(safe-area-inset-bottom)) - handled separately
 * Total: 69px (base height without safe area)
 */
:root {
    --fmbn-nav-height: 69px;
}

/* ============================================
   LAYOUT SHIFT PREVENTION
   Reserve space for bottom navigation
   ============================================ */

/**
 * Body Padding (Mobile)
 * Prevents content jump when navigation loads
 * Ensures CLS (Cumulative Layout Shift) = 0
 */
body {
    padding-bottom: calc(var(--fmbn-nav-height) + env(safe-area-inset-bottom, 0));
}

/* ============================================
   MOBILE-FIRST STYLES (Default - No Media Query)
   ============================================ */

/**
 * Navigation Container
 * Fixed to bottom of viewport, full width
 * Fixed height prevents layout shift
 * Progressive Enhancement: Works in all browsers with fallbacks
 */
.fmbn-bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 50;

    /* Fallback: Block layout (IE6+) */
    display: block;
    height: var(--fmbn-nav-height);
    width: 100%;

    /* Fallback colors: Hex values (IE6+) */
    background-color: #f9fafb;
    background-color: var(--gray-50);
    border-top: 1px solid #e5e7eb;
    border-top: 1px solid var(--gray-200);

    /* Fallback padding: Fixed value (all browsers) */
    padding-bottom: 0;
    padding-bottom: env(safe-area-inset-bottom, 0);
    padding-left: env(safe-area-inset-left, 0);
    padding-right: env(safe-area-inset-right, 0);
}

/* ============================================
   PROGRESSIVE ENHANCEMENT: Flexbox Layout
   Enhanced layout for browsers that support it (IE11+)
   ============================================ */
@supports (display: flex) {
    .fmbn-bottom-nav {
        display: flex;
        justify-content: space-around;
        align-items: stretch;
    }
}

/**
 * Navigation Item
 * Flex column layout: icon above label
 * Touch-optimized for mobile devices with minimum 44x44px targets
 * Progressive Enhancement: Works as block in older browsers, flex in modern
 */
.fmbn-nav-item {
    /* Fallback: Block display for older browsers (IE6+) */
    display: block;
    flex: 1;
    padding: 0.5rem 0.75rem;

    /* Accessibility: Minimum touch target size (WCAG 2.1 Level AA) */
    min-width: 44px;
    min-height: 44px;

    text-decoration: none;
    /* Fallback color: Hex (IE6+) */
    color: #374151;
    color: var(--gray-700);

    /* Touch Optimization */
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
    user-select: none;
    -webkit-user-select: none;
    -webkit-touch-callout: none;

    /* Smooth transitions for color and background */
    transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, opacity 0.1s ease;
}

/* ============================================
   PROGRESSIVE ENHANCEMENT: Flexbox Item Layout
   Enhanced flex layout for modern browsers (IE11+)
   ============================================ */
@supports (display: flex) {
    .fmbn-nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 0.25rem;
    }
}

/**
 * Navigation Item - Touch/Active State
 * Immediate visual feedback on touch
 * Uses opacity and subtle scale for tactile response
 */
.fmbn-nav-item:active {
    opacity: 0.7;
    transform: scale(0.95);
    transition: all 0.1s ease;
}

/**
 * Navigation Item - Focus State (Keyboard Navigation)
 * Visible focus indicator for accessibility
 */
.fmbn-nav-item:focus-visible {
    outline: 2px solid var(--primary-600);
    outline-offset: 2px;
    border-radius: 0.5rem;
}

/**
 * Navigation Item - Hover State (Desktop/Trackpad)
 * Only show hover feedback on devices with hover capability
 * Touch devices (mobile) don't get hover states
 */
@media (hover: hover) {
    .fmbn-nav-item:hover {
        color: var(--primary-600);
        background-color: var(--primary-50);
    }
}

/**
 * Navigation Item - Active State
 * Indicates current page / active item
 * Uses primary color from Filament theme
 * Progressive Enhancement: Uses fallback hex color first, then CSS variable
 */
.fmbn-nav-item--active {
    /* Fallback color: Hex (IE6+) */
    color: #3b82f6;
    color: var(--primary-600);
    /* Fallback background color: Hex (IE6+) */
    background-color: #eff6ff;
    background-color: var(--primary-50);
}

/**
 * Active Item - Hover State (Desktop)
 * Darkens active state on hover for additional feedback
 */
@media (hover: hover) {
    .fmbn-nav-item--active:hover {
        color: var(--primary-700);
        background-color: var(--primary-100);
    }
}

/**
 * Icon Container
 * Wraps SVG icon and optional badge
 */
.fmbn-nav-item__icon {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;

    width: 1.5rem; /* 24px - standard icon size */
    height: 1.5rem;
    margin-bottom: 0.25rem;

    /* Icon inherits text color from parent */
    color: currentColor;
}

/**
 * SVG Icon
 * Inherits color from parent container
 * Supports smooth color transitions
 */
.fmbn-nav-item__icon svg {
    width: 100%;
    height: 100%;
    /* Inherits currentColor from .fmbn-nav-item__icon */
    color: inherit;
}

/**
 * Label Text
 * Small text below icon
 * Uses Filament's typography system for consistency with admin panel
 * Inherits color from parent navigation item
 */
.fmbn-nav-item__label {
    /* Filament Typography Variables */
    font-family: var(--font-family);           /* Inherits Filament's font stack */
    font-size: var(--font-size-xs);            /* 12px - minimum readable size */
    font-weight: var(--font-weight-medium);    /* 500 - readable at small size */
    line-height: var(--line-height-tight);     /* 1.25 - compact spacing */

    /* Layout */
    text-align: center;

    /* Mobile optimization */
    -webkit-font-smoothing: antialiased;       /* Crisp rendering on WebKit */
    -moz-osx-font-smoothing: grayscale;        /* Crisp rendering on Firefox */
    -webkit-text-size-adjust: 100%;            /* Prevent iOS landscape zoom */
    user-select: none;                         /* Prevent accidental text selection */

    /* Text color from parent */
    color: currentColor;
}

/**
 * Badge
 * Notification indicator (positioned absolute on icon)
 * Uses Filament's semantic colors for visual meaning
 * Default: danger color (red) for alerts
 */
.fmbn-nav-item__badge {
    position: absolute;
    top: -0.25rem;
    right: -0.5rem;

    display: flex;
    align-items: center;
    justify-content: center;

    min-width: 1.25rem;
    height: 1.25rem;
    padding: 0.125rem 0.375rem;

    /* Typography - Uses Filament variables for badge styling */
    font-size: 0.625rem; /* 10px - small but readable */
    font-weight: var(--font-weight-semibold); /* 600 - bold for visibility */
    line-height: 1.25rem;                      /* Fixed height matches container */

    /* Badge styling */
    color: white; /* High contrast text */
    background-color: var(--danger-600); /* Filament danger color - red */
    border-radius: 9999px; /* Pill shape */
    border: 2px solid var(--gray-50); /* Separates from nav background */
}

/**
 * Badge Color Variants
 * Semantic colors indicating badge type
 * Color matches Filament's color system
 */
.fmbn-nav-item__badge--success {
    background-color: var(--success-600); /* Green - positive */
}

.fmbn-nav-item__badge--warning {
    background-color: var(--warning-600); /* Amber - caution */
}

.fmbn-nav-item__badge--info {
    background-color: var(--info-600); /* Blue - informational */
}

.fmbn-nav-item__badge--danger {
    background-color: var(--danger-600); /* Red - alert/error */
}

.fmbn-nav-item__badge--primary {
    background-color: var(--primary-600); /* Theme primary color */
}

/* ============================================
   DESKTOP STYLES (≥ 768px)
   Hide bottom navigation when sidebar is visible
   Remove body padding to restore full height
   ============================================ */

@media (min-width: 768px) {
    body {
        padding-bottom: 0; /* Remove reserved space on desktop */
    }

    .fmbn-bottom-nav {
        display: none;
    }
}

/* ============================================
   DARK MODE SUPPORT
   Filament automatically updates CSS variables
   No manual dark mode code or classes needed
   ============================================ */

/**
 * How Dark Mode Works:
 * - Filament updates CSS variable values when dark mode is enabled
 * - --gray-50 becomes dark gray (instead of light gray)
 * - --gray-700 becomes light gray (instead of dark gray)
 * - All color scales are inverted automatically
 * - Our CSS stays the same - only variable values change
 *
 * Example:
 * Light mode:  --gray-50: #f9fafb (light)
 * Dark mode:   --gray-50: #18181b (dark)
 *
 * Our CSS:     background-color: var(--gray-50)
 * Result: Automatically light in light mode, dark in dark mode
 */

/**
 * Theme Customization Support:
 * - Developer sets primary color: ->colors(['primary' => Color::Amber])
 * - --primary-50 through --primary-900 change to amber scale
 * - Active states automatically use amber
 * - No plugin configuration needed
 * - Works with any Filament-supported color
 */

/* ============================================
   ACCESSIBILITY ENHANCEMENTS
   ============================================ */

/**
 * Dark Mode Support
 * Navigation items in dark mode
 * Progressive Enhancement: Fallback colors with CSS variables
 */
.dark .fmbn-nav-item {
    /* Fallback color: Hex (IE6+) */
    color: #9ca3af;
    color: var(--gray-400);
}

.dark .fmbn-nav-item--active {
    /* Fallback color: Hex (IE6+) */
    color: #60a5fa;
    color: var(--primary-400);
    /* Fallback background color: Hex (IE6+) */
    background-color: #0f172a;
    background-color: var(--primary-950);
}

.dark .fmbn-nav-item:focus-visible {
    /* Fallback color: Hex (IE6+) */
    outline-color: #60a5fa;
    outline-color: var(--primary-400);
}

/**
 * High Contrast Mode Support
 * Ensures navigation is visible in Windows High Contrast Mode
 * and other high contrast accessibility settings
 */
@media (prefers-contrast: more) {
    .fmbn-nav-item {
        border: 1px solid currentColor;
    }

    .fmbn-nav-item--active {
        background-color: Highlight;
        color: HighlightText;
    }

    .fmbn-nav-item:focus-visible {
        outline-width: 3px;
    }
}

/**
 * Reduced Motion Support
 * Respects user's motion preferences
 * Disables animations and scale transforms for users who prefer reduced motion
 */
@media (prefers-reduced-motion: reduce) {
    .fmbn-nav-item {
        transition: none;
    }

    .fmbn-nav-item:active {
        transform: none; /* No scale animation */
        transition: none;
    }
}

/**
 * Forced Colors Mode Support
 * For high contrast and accessibility tools
 */
@media (forced-colors: active) {
    .fmbn-nav-item {
        border: 1px solid ButtonText;
    }

    .fmbn-nav-item--active {
        background-color: Highlight;
        color: HighlightText;
    }
}

/* ============================================
   PRINT STYLES
   Hide navigation when printing
   ============================================ */

@media print {
    .fmbn-bottom-nav {
        display: none;
    }

    body {
        padding-bottom: 0;
    }
}
